<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ZOO VPN PREMIUM</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { 
            --bg: #0f0c29; 
            --glass: rgba(255, 255, 255, 0.07); 
            --accent-pink: #ff0080; 
            --accent-cyan: #00dfd8; 
            --text: #ffffff; 
        }
        body { 
            margin: 0; 
            padding: 20px; 
            background: linear-gradient(to bottom, #0f0c29, #302b63, #24243e); 
            color: var(--text); 
            font-family: 'Segoe UI', sans-serif; 
            overflow: hidden; 
            min-height: 100vh; 
        }
        .stars-container { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            z-index: -1; 
        }
        .star { 
            position: absolute; 
            background: white; 
            border-radius: 50%; 
            opacity: 0.5; 
            animation: move linear infinite; 
        }
        @keyframes move { 
            from { transform: translateY(100vh); } 
            to { transform: translateY(-10vh); } 
        }
        .main-container { 
            position: relative; 
            z-index: 1; 
            display: flex; 
            flex-direction: column; 
            gap: 12px; 
        }
        .card-balance { 
            background: var(--glass); 
            backdrop-filter: blur(15px); 
            border: 1px solid rgba(255, 0, 128, 0.3); 
            border-radius: 25px; 
            padding: 20px; 
            text-align: center; 
        }
        .balance-val { 
            font-size: 42px; 
            font-weight: 800; 
            background: linear-gradient(45deg, var(--accent-pink), var(--accent-cyan)); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
        }
        .grid-info { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 10px; 
        }
        .box { 
            background: var(--glass); 
            backdrop-filter: blur(10px); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            padding: 12px; 
            border-radius: 20px; 
            text-align: center; 
        }
        .box-title { font-size: 10px; opacity: 0.6; text-transform: uppercase; margin-bottom: 3px; }
        .box-data { font-size: 14px; font-weight: 600; }
        .btn { 
            border: none; 
            padding: 18px; 
            border-radius: 20px; 
            font-size: 15px; 
            font-weight: 800; 
            color: white; 
            cursor: pointer; 
            transition: 0.3s; 
            width: 100%; 
            margin-top: 5px; 
        }
        .btn-rocket { 
            background: linear-gradient(45deg, #00c6ff, #0072ff); 
            box-shadow: 0 5px 15px rgba(0, 114, 255, 0.4); 
            animation: pulse 2s infinite; 
        }
        .btn-vpn { background: linear-gradient(45deg, #ff0080, #7928ca); }
        .btn-pay { background: linear-gradient(45deg, #00dfd8, #007cf0); }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
        
        .modal { 
            position: fixed; 
            bottom: -100%; 
            left: 0; 
            width: 100%; 
            background: #1a1a2e; 
            border-top: 2px solid var(--accent-cyan); 
            border-top-left-radius: 30px; 
            border-top-right-radius: 30px; 
            padding: 25px 20px; 
            z-index: 100; 
            transition: 0.4s; 
            box-sizing: border-box; 
        }
        .modal.active { bottom: 0; }
        input { 
            width: 100%; 
            padding: 15px; 
            border-radius: 15px; 
            border: 1px solid var(--accent-cyan); 
            background: rgba(255,255,255,0.05); 
            color: white; 
            font-size: 20px; 
            text-align: center; 
            margin-bottom: 20px; 
            box-sizing: border-box; 
        }
        .pay-option { 
            background: rgba(255,255,255,0.05); 
            padding: 15px; 
            border-radius: 20px; 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            margin-bottom: 10px; 
        }
    </style>
</head>
<body>
    <div class="stars-container" id="stars"></div>
    <div class="main-container" id="mainContent">
        <div class="card-balance">
            <div style="font-size: 13px;">–í–∞—à –±–∞–ª–∞–Ω—Å</div>
            <div class="balance-val" id="balanceDisplay">0.00 ‚ÇΩ</div>
            <div style="font-size: 10px; opacity: 0.5;" id="userDisplay">ID: ---</div>
        </div>
        <div class="grid-info">
            <div class="box">
                <div class="box-title">–°—Ç–∞—Ç—É—Å</div>
                <div class="box-data" id="statusDisplay" style="color:#ff4d4d">‚óè –ù–µ –∞–∫—Ç–∏–≤–µ–Ω</div>
            </div>
            <div class="box">
                <div class="box-title">–î–æ—Å—Ç—É–ø–Ω–æ</div>
                <div class="box-data" id="daysDisplay">0 –¥–Ω–µ–π</div>
            </div>
        </div>
        
        <button class="btn btn-rocket" onclick="connectRocket()">üöÄ –ü–û–î–ö–õ–Æ–ß–ò–¢–¨ (V2BOX)</button>
        
        <button class="btn btn-vpn" onclick="openTariffModal()">üíé –í–´–ë–†–ê–¢–¨ –¢–ê–†–ò–§</button>
        <button class="btn btn-pay" onclick="openAmountModal()">üí≥ –ü–û–ü–û–õ–ù–ò–¢–¨ –ë–ê–õ–ê–ù–°</button>
    </div>

    <div class="modal" id="tariffModal">
        <div style="text-align:center; margin-bottom:20px; font-weight:700;">–¢–ê–†–ò–§–´</div>
        <div class="pay-option" onclick="confirmBuy(1, 299)">1 –ú–µ—Å—è—Ü - 299 ‚ÇΩ</div>
        <div class="pay-option" onclick="confirmBuy(3, 834)">3 –ú–µ—Å—è—Ü–∞ - 834 ‚ÇΩ</div>
        <div style="text-align:center; margin-top:15px; opacity:0.5" onclick="closeAll()">–ó–∞–∫—Ä—ã—Ç—å</div>
    </div>
    
    <div class="modal" id="amountModal">
        <input type="number" id="sumInput" placeholder="–°—É–º–º–∞ (‚ÇΩ)">
        <button class="btn btn-pay" onclick="sendPayment()">–ü–û–ü–û–õ–ù–ò–¢–¨</button>
        <div style="text-align:center; margin-top:15px; opacity:0.5" onclick="closeAll()">–û—Ç–º–µ–Ω–∞</div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        
        const params = new URLSearchParams(window.location.search);
        const balance = params.get('balance') || "0";
        const days = params.get('days') || "0";
        const vlessLink = decodeURIComponent(params.get('vless') || "");

        document.getElementById('balanceDisplay').innerText = balance + " ‚ÇΩ";
        document.getElementById('userDisplay').innerText = "ID: " + params.get('id');
        document.getElementById('daysDisplay').innerText = days + " –¥–Ω–µ–π";
        if (parseInt(days) > 0) { 
            document.getElementById('statusDisplay').innerText = "‚óè –ê–∫—Ç–∏–≤–µ–Ω"; 
            document.getElementById('statusDisplay').style.color = "#00ff00"; 
        }

        function connectRocket() {
            if (parseInt(days) <= 0) return tg.showAlert("–°–Ω–∞—á–∞–ª–∞ –∫—É–ø–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É!");
            
            // –ü—Ä—è–º–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è V2Box (–≤—à–∏–≤–∞–µ–º –∫–æ–Ω—Ñ–∏–≥ —Å—Ä–∞–∑—É)
            const v2boxDeepLink = "v2box://install-config?url=" + encodeURIComponent(vlessLink);
            
            // 1. –ü–ï–†–ï–•–û–î –í –ü–†–ò–õ–û–ñ–ï–ù–ò–ï (–≠–¢–û –¢–ê –°–ê–ú–ê–Ø –ö–ù–û–ü–ö–ê)
            window.location.replace(v2boxDeepLink);

            // 2. –ó–ê–ü–ê–°–ù–û–ô –í–ê–†–ò–ê–ù–¢ (—Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –æ—Ç–∫—Ä—ã–ª–æ—Å—å —á–µ—Ä–µ–∑ 3 —Å–µ–∫)
            setTimeout(() => {
                if (document.visibilityState === 'visible') {
                    tg.showPopup({
                        title: "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å V2Box",
                        message: "–ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —Å–∫–∞—á–∞–π—Ç–µ –µ–≥–æ –ø–æ —Å—Å—ã–ª–∫–µ –Ω–∏–∂–µ.",
                        buttons: [
                            {id: "download", type: "default", text: "–°–∫–∞—á–∞—Ç—å V2Box"},
                            {id: "ok", type: "destructive", text: "–ó–∞–∫—Ä—ã—Ç—å"}
                        ]
                    }, (buttonId) => {
                        if (buttonId === "download") {
                            tg.openLink("https://apps.apple.com/us/app/v2box-v2ray-client/id6446814690?l=ru");
                        }
                    });
                }
            }, 3000);
        }

        function openTariffModal() { document.getElementById('tariffModal').classList.add('active'); }
        function openAmountModal() { document.getElementById('amountModal').classList.add('active'); }
        function closeAll() { document.querySelectorAll('.modal').forEach(m => m.classList.remove('active')); }
        
        function sendPayment() {
            const val = document.getElementById('sumInput').value;
            if(!val) return;
            tg.sendData(JSON.stringify({action: 'pay', amount: val}));
            tg.close();
        }

        function confirmBuy(m, p) {
            if (parseFloat(balance) < p) return tg.showAlert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!");
            tg.sendData(JSON.stringify({action: "buy_subscription", months: m, price: p}));
            setTimeout(() => tg.close(), 100);
        }

        // –ó–≤–µ–∑–¥—ã
        const container = document.getElementById('stars');
        for (let i = 0; i < 30; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            star.style.width = star.style.height = Math.random() * 2 + 'px';
            star.style.left = Math.random() * 100 + 'vw';
            star.style.animationDuration = Math.random() * 3 + 2 + 's';
            container.appendChild(star);
        }
    </script>
</body>
</html>
