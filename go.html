<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rocket VPN - Подключение</title>
    <style>
        body { background: #0f0c29; color: white; font-family: sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; text-align: center; }
        .loader-box { padding: 20px; }
        .btn-choice { display: block; background: #00dfd8; color: #0f0c29; padding: 15px 25px; text-decoration: none; border-radius: 12px; font-weight: bold; margin: 10px auto; width: 250px; }
        .btn-happ { background: #f093fb; }
        h2 { font-size: 18px; color: #fff; margin-bottom: 25px; }
        .hint { font-size: 12px; opacity: 0.6; margin-top: 20px; }
    </style>
</head>
<body>

    <div class="loader-box">
        <h2 id="status">Выберите ваше приложение:</h2>
        
        <a href="#" id="happ-link" class="btn-choice btn-happ">ОТКРЫТЬ В HAPP</a>
        
        <a href="#" id="v2box-link" class="btn-choice">ОТКРЫТЬ В V2BOX</a>

        <p class="hint">Если приложение установлено, импорт начнется автоматически после нажатия.</p>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const base64Config = urlParams.get('enc');
        
        if (base64Config) {
            const vlessLink = atob(base64Config);
            
            // Ссылки для разных приложений
            const v2boxUrl = "v2box://install-config?url=" + encodeURIComponent(vlessLink);
            const happUrl = "happ://import/" + vlessLink; // Happ понимает прямую ссылку без кодирования всего URL

            document.getElementById('v2box-link').href = v2boxUrl;
            document.getElementById('happ-link').href = happUrl;

            // Авто-попытка открыть (сначала пробуем Happ, так как он стабильнее)
            const isAndroid = /Android/i.test(navigator.userAgent);
            if (isAndroid) {
                window.location.href = happUrl;
                // Если через секунду не ушли с сайта, пробуем v2box
                setTimeout(() => { window.location.href = v2boxUrl; }, 1000);
            } else {
                window.location.href = v2boxUrl;
            }
        } else {
            document.getElementById('status').innerText = "Ошибка: Ключ не найден";
        }
    </script>
</body>
</html>
